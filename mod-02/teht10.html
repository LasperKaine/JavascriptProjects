<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      (function () {
        const candidates = [];
        let numCandidates = 0;

        while (true) {
          const numInput = prompt("Enter the number of candidates:");
          if (numInput === null) return;
          numCandidates = parseInt(numInput, 10);
          if (!isNaN(numCandidates) && numCandidates > 0) {
            break;
          } else {
            console.log("Please enter a valid positive number.");
          }
        }

        for (let i = 0; i < numCandidates; i++) {
          let name = "";
          while (true) {
            name = prompt(`Name for candidate ${i + 1}:`);
            if (name === null) return;
            if (name.trim() !== "") {
              candidates.push({ name: name.trim(), votes: 0 });
              break;
            } else {
              console.log("Please enter a name.");
            }
          }
        }

        let numVoters = 0;
        while (true) {
          const numInput = prompt("Enter the number of voters:");
          if (numInput === null) return;
          numVoters = parseInt(numInput, 10);
          if (!isNaN(numVoters) && numVoters > 0) {
            break;
          } else {
            console.log("Please enter a valid positive number.");
          }
        }

        for (let i = 0; i < numVoters; i++) {
          const vote = prompt(`Voter ${i + 1}, who will you vote for?`);

          if (vote === null) continue;

          const trimmedVote = vote.trim();

          if (trimmedVote === "") {
            console.log("Voter ${i + 1} cast an empty vote.");
            continue;
          }

          let found = false;
          for (let j = 0; j < candidates.length; j++) {
            if (
              candidates[j].name.toLowerCase() === trimmedVote.toLowerCase()
            ) {
              candidates[j].votes++;
              found = true;
              break;
            }
          }

          if (!found && trimmedVote !== "") {
            console.log(
              `Voter ${
                i + 1
              } voted for '${trimmedVote}', which is not a valid candidate. Vote not counted.`
            );
          }
        }

        candidates.sort((a, b) => {
          return b.votes - a.votes;
        });

        if (candidates.length > 0) {
          console.log(
            `The winner is ${candidates[0].name} with ${candidates[0].votes} votes.`
          );
          console.log("results:");
          for (const candidate of candidates) {
            console.log(`${candidate.name}: ${candidate.votes} votes`);
          }
        } else {
          console.log("No candidates were entered. No results to show.");
        }
      })();
    </script>
  </body>
</html>
